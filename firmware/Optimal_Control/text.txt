Add also from casadi import sqrt, vertcat

# Friction coefficient (dry asphalt)
mu = 1.2  

# Vertical forces (approximate distribution by axis)
Fzf = m * g * (b / (a + b))
Fzr = m * g * (a / (a + b))

# Forces from Pacejka model
Fyf = pacejka_lateral_force(Bf, Cf, Df, alpha_f)
Fyr = pacejka_lateral_force(Br, Cr, Dr, alpha_r)

# Friction constraint (so-called "friction ellipse")
# sqrt(Fx^2 + Fy^2) ≤ μ * Fz
constraints = []

# Front axis
constraints.append(sqrt(Fxf**2 + Fyf**2) - mu * Fzf)
# Rear axis
constraints.append(sqrt(Fxr**2 + Fyr**2) - mu * Fzr)

# Add these constraints to the optimization problem
for c in constraints:
    opti.subject_to(c <= 0)

and use combined "friction ellipse" with dynamic reduction of lateral force when applying longitudinal (Fx) — realistic for acceleration/braking in corner
